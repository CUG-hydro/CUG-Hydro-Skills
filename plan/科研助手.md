# CUG-Hydro 科研 Agent 系统

基于 [everything-claude-code](https://github.com/affaan-m/everything-claude-code) 范式设计的科研工作流助手系统。

## 核心理念

**借鉴范式 > 盲目安装**

本系统借鉴 ECC 的设计理念（Agent 模式、Hook 自动化、上下文管理），但针对科研工作的特殊需求进行定制：

- 科学计算代码审查（数值稳定性、算法复杂度）
- 论文写作助手（逻辑论证、文献引用）
- 实验设计模式（对照组、统计功效）
- 数据分析流程（可视化、可复现性）

## 目录结构

```
agents/                 # 科研专用 Agent
├── paper-reviewer.md      # 论文审查 Agent
├── code-reviewer-scientific.md  # 科学计算代码审查 Agent
└── data-viz-reviewer.md   # 数据可视化审查 Agent

contexts/               # 动态系统提示上下文
├── writing.md            # 论文写作模式
├── computation.md        # 科学计算模式
└── discussion.md         # 学术讨论模式

hooks/                  # 自动化钩子
└── hooks.json            # 事件驱动自动化配置

rules/                  # 规则库
├── common/
│   ├── reproducibility.md   # 可复现性要求
│   └── ethics.md            # 科研伦理
├── julia/
│   ├── numerical-stability.md  # 数值稳定性
│   └── parallel-computing.md   # 并行计算安全
└── latex/
    ├── citation-format.md      # 引用格式
    └── figure-standards.md     # 图表标准
```

## Agent 说明

### paper-reviewer

**用途**: 审查科研论文的逻辑严谨性、方法完整性和写作质量

**触发时机**:
```bash
# 审查论文草稿
claude --system-prompt "$(cat contexts/writing.md)"
# 然后请求: "请审查这篇论文"
```

**审查重点**:
- IMRaD 结构完整性
- 研究问题清晰度
- 方法可复现性
- 结论是否被数据支持
- 文献引用规范性

### code-reviewer-scientific

**用途**: 审查科学计算代码的数值稳定性、算法效率和可复现性

**触发时机**:
```bash
# 审查 Julia/Python/R 代码
# 在 computation.md 上下文中
claude --system-prompt "$(cat contexts/computation.md)"
```

**审查重点**:
- 除零保护、浮点运算问题
- 随机种子设置
- 并行计算安全性
- 类型稳定性（Julia）
- 单位一致性

### data-viz-reviewer

**用途**: 审查科学数据可视化的清晰度、准确性和可访问性

**审查重点**:
- 色盲友好的配色
- 坐标轴标签和单位
- 图题自明性
- 期刊格式要求
- 分辨率设置

## 上下文使用

### 使用方法

```bash
# 论文写作模式
alias claude-write='claude --system-prompt "$(cat ~/.claude/contexts/writing.md)"'

# 科学计算模式
alias claude-code='claude --system-prompt "$(cat ~/.claude/contexts/computation.md)"'

# 学术讨论模式
alias claude-discuss='claude --system-prompt "$(cat ~/.claude/contexts/discussion.md)"'
```

### 场景选择

| 场景 | 推荐上下文 | Agent |
|------|-----------|-------|
| 撰写论文 | writing | paper-reviewer |
| 开发模型 | computation | code-reviewer-scientific |
| 绘制图表 | writing | data-viz-reviewer |
| 讨论方法 | discussion | - |
| 审查代码 | computation | code-reviewer-scientific |

## Hooks 自动化

当前配置的自动化钩子：

| 触发条件 | 行为 |
|---------|------|
| 写入 .jl 文件 | 提醒检查数值稳定性和单位一致性 |
| 写入 .tex/.md 文件 | 提醒检查引用格式和参考文献完整性 |
| 修改 .jl 文件 | 提醒运行测试验证数值结果 |
| 保存图片 | 提醒检查分辨率和字体大小 |
| git commit/push | 提醒提交前检查清单 |

### 安装 Hooks

将 `hooks/hooks.json` 的内容复制到你的 `~/.claude/settings.json` 文件中。

## 规则库使用

规则库提供具体的技术规范，可在开发时参考：

```bash
# 查看数值稳定性规则
cat rules/julia/numerical-stability.md

# 查看 LaTeX 引用规范
cat rules/latex/citation-format.md
```

## 最佳实践

### 1. 渐进式采用

不需要一次性使用所有 Agent。根据当前任务选择合适的工具：

```bash
# 今天写论文
claude --system-prompt "$(cat contexts/writing.md)"

# 明天写代码
claude --system-prompt "$(cat contexts/computation.md)"
```

### 2. 结合使用

多个 Agent 可以协同工作：

```markdown
用户: "请帮我审查这篇论文的图表"

Claude (使用 writing.md 上下文):
1. 调用 data-viz-reviewer 审查图表质量
2. 调用 paper-reviewer 审查图表与文本的一致性
```

### 3. 持续迭代

根据实际使用反馈，不断完善 Agent 和规则：

- 发现新的常见错误？添加到 code-reviewer
- 新的期刊格式要求？更新 figure-standards.md
- 新的数值问题模式？添加到 numerical-stability.md

## 与 ECC 的区别

| 特性 | ECC (软件开发) | 本系统 (科研工作) |
|------|---------------|------------------|
| 主要语言 | TypeScript, Go, Python | Julia, Python, R |
| 审查重点 | Web安全、API设计、并发模式 | 数值稳定性、可复现性、物理一致性 |
| 文档类型 | API文档、README | 学术论文、技术报告 |
| 版本控制 | 功能分支、语义化版本 | 实验版本、数据版本 |
| 部署目标 | 生产服务器 | 期刊投稿、数据发布 |

## 扩展计划

- [ ] Python 代码审查规则
- [ ] R 代码审查规则
- [ ] 水文模型特定规则（HBV、SWAT、VIC）
- [ ] 气候数据处理方法
- [ ] 统计分析审查 Agent
- [ ] 项目初始化命令

## 参考

- [everything-claude-code](https://github.com/affaan-m/everything-claude-code) - 原始范式来源
- [Claude Code 文档](https://docs.anthropic.com/en/docs/claude-code)
- [Julia 性能指南](https://docs.julialang.org/en/v1/manual/performance-tips/)
- [FAIR 数据原则](https://www.go-fair.org/fair-principles/)

## License

本系统借鉴 everything-claude-code 的设计理念，遵循相同的 MIT 许可证。
